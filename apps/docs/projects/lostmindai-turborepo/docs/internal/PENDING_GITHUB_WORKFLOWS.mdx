<Info>
This content was automatically extracted from LostMindAI-TurboRepo.
For the most up-to-date information, refer to the source project.
</Info>

# GitHub Workflows to Add Manually

Due to GitHub OAuth permission restrictions, these workflow files need to be added manually through the GitHub web interface or by someone with workflow permissions.

## 1. Dependency Updates Workflow

Create `.github/workflows/dependency-updates.yml`:

```yaml
name: Dependency Updates

on:
  schedule:
    # Run every Monday at 9am UTC
    - cron: '0 9 * * 1'
  workflow_dispatch: # Allow manual trigger

jobs:
  check-updates:
    name: Check for Updates
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup PNPM
        uses: pnpm/action-setup@v4
      
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: pnpm
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Check for outdated packages
        id: outdated
        run: |
          echo "## üì¶ Dependency Update Report" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          echo "### Outdated Packages:" >> $GITHUB_STEP_SUMMARY
          echo '```' >> $GITHUB_STEP_SUMMARY
          pnpm outdated >> $GITHUB_STEP_SUMMARY 2>&1 || true
          echo '```' >> $GITHUB_STEP_SUMMARY
      
      - name: Security audit
        run: |
          echo "### üîí Security Audit:" >> $GITHUB_STEP_SUMMARY
          echo '```' >> $GITHUB_STEP_SUMMARY
          pnpm audit --audit-level=moderate >> $GITHUB_STEP_SUMMARY 2>&1 || true
          echo '```' >> $GITHUB_STEP_SUMMARY
      
      - name: Create update summary
        run: |
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### üìã Recommended Actions:" >> $GITHUB_STEP_SUMMARY
          echo "1. Review outdated packages above" >> $GITHUB_STEP_SUMMARY
          echo "2. Run \`pnpm run update:check\` locally" >> $GITHUB_STEP_SUMMARY
          echo "3. Use \`pnpm run update:safe\` for patch updates" >> $GITHUB_STEP_SUMMARY
          echo "4. Test thoroughly after updates" >> $GITHUB_STEP_SUMMARY

  dependabot-auto-merge:
    name: Auto-merge Dependabot PRs
    runs-on: ubuntu-latest
    if: github.actor == 'dependabot[bot]'
    steps:
      - name: Dependabot metadata
        id: metadata
        uses: dependabot/fetch-metadata@v2
        with:
          github-token: "${{ secrets.GITHUB_TOKEN }}"
      
      - name: Auto-merge patch and minor updates
        if: steps.metadata.outputs.update-type == 'version-update:semver-patch' || steps.metadata.outputs.update-type == 'version-update:semver-minor'
        run: gh pr merge --auto --merge "$PR_URL"
        env:
          PR_URL: ${{github.event.pull_request.html_url}}
          GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
```

## 2. Safety Net Workflow

Create `.github/workflows/safety-net.yml`:

```yaml
name: Safety Net

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  secret-scanning:
    name: Scan for Exposed Secrets
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: TruffleHog Secret Scan
        uses: trufflesecurity/trufflehog@main
        with:
          path: ./
          base: ${{ github.event.repository.default_branch }}
          head: HEAD
          extra_args: --debug --only-verified

  dependency-check:
    name: Check Dependencies
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup PNPM
        uses: pnpm/action-setup@v4
      
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: pnpm
      
      - name: Audit dependencies
        run: |
          pnpm audit --audit-level=high || echo "::warning::High severity vulnerabilities found"
      
      - name: Check for outdated packages
        run: |
          pnpm outdated || true

  code-quality:
    name: Code Quality Checks
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup PNPM
        uses: pnpm/action-setup@v4
      
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: pnpm
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Check formatting
        run: pnpm run format:check
      
      - name: ESLint check
        run: pnpm run lint
      
      - name: TypeScript check
        run: pnpm run type-check

  size-check:
    name: Bundle Size Check
    runs-on: ubuntu-latest
    if: github.event_name == 'pull_request'
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup PNPM
        uses: pnpm/action-setup@v4
      
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: pnpm
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Build project
        run: pnpm run build
      
      - name: Check build output size
        run: |
          echo "Build sizes:"
          find apps -name ".next" -type d | while read dir; do
            echo "$(dirname $dir):"
            du -sh "$dir" | awk '{print "  Total: " $1}'
          done

  database-safety:
    name: Database Migration Safety
    runs-on: ubuntu-latest
    if: contains(github.event.head_commit.message, 'migration') || contains(github.event.head_commit.message, 'schema')
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup PNPM
        uses: pnpm/action-setup@v4
      
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: pnpm
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Check for breaking schema changes
        run: |
          echo "::warning::Database schema changes detected. Please ensure:"
          echo "  1. Migrations are backward compatible"
          echo "  2. RLS policies are maintained"
          echo "  3. Indexes are preserved"
          echo "  4. Test rollback procedure"

  deployment-readiness:
    name: Deployment Readiness Check
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Check environment variables
        run: |
          echo "Checking for required environment variables in .env.example..."
          required_vars=(
            "DATABASE_URL"
            "NEXTAUTH_SECRET"
            "GOOGLE_CLIENT_ID"
            "STRIPE_SECRET_KEY"
          )
          
          for var in "${required_vars[@]}"; do
            if grep -q "^$var=" .env.example; then
              echo "‚úÖ $var is documented"
            else
              echo "‚ùå $var is missing from .env.example"
              exit 1
            fi
          done
      
      - name: Verify build succeeds
        run: |
          echo "::notice::Ready for deployment if all checks pass"
```

## How to Add These Workflows

1. Go to your GitHub repository
2. Click on "Actions" tab
3. Click "New workflow"
4. Click "set up a workflow yourself"
5. Copy and paste each workflow content
6. Commit directly to main branch

Or, if you have proper permissions locally:
```bash
git checkout -b add-workflows
# Create the files manually
git add .github/workflows/
git commit -m "chore: add GitHub Actions workflows for safety and dependency management"
git push origin add-workflows
# Create PR and merge
```

These workflows will provide:
- Weekly dependency checks
- Automatic Dependabot PR merging
- Secret scanning on every push
- Code quality checks
- Bundle size monitoring
- Database migration safety checks
- Deployment readiness validation