---
title: "Secrets Policy"
description: "documentation for LostMindAI-TurboRepo"
category: "documentation"
project: "LostMindAI-TurboRepo"
lastUpdated: "2025-09-21"
tags: "documentation,main-platform"
---

# Secrets Policy — LostMind AI (Internal)

This policy defines how environment secrets are managed for apps and services.

## Principles

- Never commit real secrets to the repository. Only `.env.example` is committed.
- Production/staging app secrets live in Vercel Environment Variables.
- Backend service secrets live in GCP Secret Manager and are injected into Cloud Run.
- Rotate compromised or exposed secrets immediately and audit usage.

## Allowed Locations for Secrets

- Development (local): Developer machine only, not checked into git. Prefer `.env.local` untracked.
- Vercel:
  - NEXTAUTH, Stripe, OAuth, analytics keys per environment (Development/Preview/Production).
- GCP Secret Manager (Cloud Run services):
  - Database URLs, Stripe keys, service tokens. Referenced via `env.value_source.secret_key_ref` in Terraform.

## What Is Committed

- `.env.example` with placeholders and safe defaults only.
- No real keys, tokens, or secrets.

## Rotation Procedure

1. Generate a new secret in the provider (Stripe, Google, DB, etc.).
2. Update Vercel Environment Variables and/or GCP Secret Manager with the new value.
3. Redeploy affected apps/services.
4. Invalidate/revoke the old secret (provider dashboard) and document the rotation.
5. If a secret was committed to git by mistake:
   - Remove the file from tracking (`git rm --cached <file>`),
   - Force-rotate the secret immediately,
   - Avoid rewriting git history unless strictly necessary.

## Reviews & CI

- PR checklist must include: “No secrets in code or config”.
- Consider using a pre-commit or CI secret scanner (e.g., `gitleaks`) for detection.

## Environment Variable Guidance

- Prefer `ALLOWED_TESTERS` for soft-launch gating (comma-separated emails).
- Keep domain variables accurate and environment-agnostic in `.env.example`.
- Do not hard-code old domains like `studio.lostmindai.com`.

## Terraform & Secret Manager

- Cloud Run services should use secrets via:
  - `env { name = "FOO" value_source { secret_key_ref { secret = "foo" version = "latest" } } }`
- Secrets must be created and granted access to service accounts ahead of deploy.

## Incident Response

- If a secret is exposed:
  - Rotate immediately, notify stakeholders, and review access logs.
  - Create a short incident note (what happened, impact, mitigation) in `docs/incidents/`.



---
*This content was automatically extracted from LostMindAI-TurboRepo. For the most up-to-date information, refer to the source project.*
